# path: ./Caddyfile
# version: 1

:80 {
    # Root directory for static files
    root * /usr/share/caddy

    # Enable file serving
    file_server

    # SPA fallback - serve index.html for all routes
    try_files {path} /index.html

    # Enable gzip compression
    encode gzip

    # Add security headers
    header {
        # Prevent clickjacking
        X-Frame-Options "SAMEORIGIN"
        # XSS protection
        X-Content-Type-Options "nosniff"
        # Remove server header
        -Server
    }

    # CORS headers for API requests (adjust origins as needed)
    @cors {
        header Origin *
    }
    header @cors {
        Access-Control-Allow-Origin "*"
        Access-Control-Allow-Methods "GET, POST, PUT, DELETE, OPTIONS"
        Access-Control-Allow-Headers "Content-Type, Authorization"
    }

    # Health check endpoint
    respond /health 200

    # Logging
    log {
        output stdout
        format console
    }
}